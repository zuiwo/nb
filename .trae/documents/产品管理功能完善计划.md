# 产品管理功能完善计划

## 1. 后端调整

### 1.1 数据库结构修改
- 修改`products`表，添加以下字段：
  - `code`：产品编号（VARCHAR(20)，唯一索引）
  - `category`：产品分类（VARCHAR(50)）
  - `brand`：品牌（VARCHAR(50)）
  - `unit`：单位（VARCHAR(20)）
  - `status`：启用状态（TINYINT，0-禁用，1-启用）
  - `remark`：备注（TEXT）

### 1.2 API调整
- 更新产品模型，添加新字段
- 修改创建和更新产品的请求结构
- 实现产品编号自动生成逻辑（P+5位数字递增）
- 实现产品编号唯一性验证
- 添加批量删除API

## 2. 前端调整

### 2.1 类型定义更新
- 更新`Product`、`CreateProductDto`和`UpdateProductDto`接口，添加新字段
- 移除不需要的字段（如price、costPrice、stock、supplier等）

### 2.2 表单组件修改
- 更新`ProductForm`组件，添加新字段的表单控件
- 产品编号默认值设置为自动生成的格式
- 品牌、单位字段使用下拉选择或输入框
- 启用状态使用开关组件
- 备注使用文本域

### 2.3 产品管理页面调整
- 调整布局：标题、查询区域、操作按钮分三行显示
- 添加批量删除功能
- 实现表格行勾选功能
- 更新查询条件：产品编号、产品名、产品分类、启用状态
- 实现按创建时间倒序排序

### 2.4 搜索和筛选功能
- 添加产品编号搜索框
- 添加产品名称搜索框
- 添加产品分类下拉筛选
- 添加启用状态下拉筛选

## 3. Bug修复
- 修复新增产品时的bug（当前代码中使用了错误的状态变量`setIsModalVisible`）
- 确保表单提交后正确关闭抽屉

## 4. 代码质量保证
- 修复lint错误
- 确保类型安全
- 测试所有功能（增删改查、批量删除、搜索筛选等）

## 5. 实现步骤

1. 修改后端数据库结构
2. 更新后端API和模型
3. 更新前端类型定义
4. 修改ProductForm组件
5. 调整产品管理页面布局和功能
6. 实现搜索和筛选功能
7. 修复bug
8. 测试所有功能
9. 修复代码质量问题

## 6. 关键技术点

- 产品编号自动生成逻辑
- 批量删除功能实现
- 表格行勾选和状态管理
- 多条件搜索和筛选
- 前后端数据格式对齐

## 7. 预期效果

- 产品管理页面布局符合原型要求
- 支持产品的增删改查功能
- 支持批量删除
- 支持多条件搜索和筛选
- 产品编号自动生成且唯一
- 所有功能正常工作，无bug

## 8. 注意事项

- 确保数据库字段类型和长度设置合理
- 实现产品编号唯一性验证，避免重复
- 批量删除功能需要添加确认提示
- 搜索和筛选功能需要优化性能
- 确保前后端数据格式一致
- 测试所有边界情况

## 9. 测试计划

- 测试产品创建功能，包括自动生成产品编号
- 测试产品编辑功能
- 测试产品删除功能（单行和批量）
- 测试搜索和筛选功能
- 测试启用/禁用状态切换
- 测试产品编号唯一性验证
- 测试表单验证
- 测试页面布局和响应式设计

## 10. 代码质量保证

- 修复所有lint错误
- 确保类型安全
- 优化代码结构和可读性
- 添加必要的注释
- 遵循代码规范

通过以上计划，我将确保产品管理功能完全符合用户需求，并且代码质量高、性能好、用户体验佳。