# 销售系统需求文档

## 1. 概述

本文档描述了销售系统的完整需求，包括基础信息管理模块（客户管理、产品管理、字典管理）和业务操作模块（销售管理、收款管理）。

## 2. 客户管理

### 2.1 功能概述
客户管理功能实现客户信息的完整CRUD操作，包括客户基本信息管理和发票信息管理，并支持灵活的查询功能。

### 2.2 字段定义

#### 2.2.1 客户基本信息

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 客户编号 | 字符串 | 4位 | 必填，唯一，默认4位数字递增，可编辑 | 客户唯一标识 |
| 客户名 | 字符串 | 50 | 必填 | 客户姓名或公司简称 |
| 手机号 | 字符串 | 11 | 必填，格式验证 | 客户联系电话 |
| 省份-城市-区县 | 字符串 | - | 必填 | 客户所在地，三级联动选择 |
| 详细地址 | 字符串 | 200 | 可选 | 客户详细地址 |
| 公司名 | 字符串 | 100 | 可选 | 客户所属公司名称 |
| 启用状态 | 布尔值 | - | 必填，默认启用 | 客户是否启用 |
| 备注 | 文本 | - | 可选 | 客户相关备注信息 |

#### 2.2.2 发票信息列表

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 公司名 | 字符串 | 100 | 必填 | 发票抬头公司名称 |
| 税号 | 字符串 | 20 | 必填，唯一 | 纳税人识别号 |
| 开户银行 | 字符串 | 100 | 必填 | 开户银行名称 |
| 银行账号 | 字符串 | 30 | 必填 | 银行账号 |
| 支行地址 | 字符串 | 200 | 可选 | 银行支行详细地址 |
| 启用状态 | 布尔值 | - | 必填，默认启用 | 发票信息是否启用 |

### 2.3 功能需求

#### 2.3.1 客户列表
- 展示所有客户信息，支持分页和列排序
- 支持单个输入框查询所有字段
- 提供新增、编辑、删除客户操作按钮
- 支持批量删除客户功能

#### 2.3.2 客户创建/编辑
- 使用抽屉式表单进行客户信息录入和编辑
- 表单验证确保必填字段和数据格式正确
- 客户编号默认4位数字递增，可手动编辑，但需确保唯一性
- 支持三级联动选择省份-城市-区县
- 启用状态使用开关组件控制

#### 2.3.3 发票信息管理
- 每个客户可关联多条发票信息
- 支持发票信息的增删改查操作
- 发票信息列表展示在客户详情中
- 支持设置默认发票信息

#### 2.3.4 客户查询
- 单个输入框模糊查询，支持查询所有客户字段
- 支持按启用状态筛选

### 2.4 操作流程

1. **客户创建流程**：
   - 点击"新增客户"按钮
   - 填写客户基本信息
   - 添加发票信息（可选）
   - 提交表单，系统验证数据
   - 验证通过后保存客户信息

2. **客户编辑流程**：
   - 在客户列表中点击"编辑"按钮
   - 修改客户信息
   - 更新发票信息
   - 提交表单，系统验证数据
   - 验证通过后更新客户信息

3. **客户删除流程**：
   - 在客户列表中点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除客户信息
   - 同时删除关联的发票信息

4. **批量删除流程**：
   - 在客户列表中选择多个客户
   - 点击"批量删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除所选客户
   - 同时删除关联的发票信息

## 3. 产品管理

### 3.1 功能概述
产品管理功能实现产品信息的完整CRUD操作，包括产品列表展示、创建、编辑、删除和批量删除功能，并支持灵活的搜索过滤。

### 3.2 字段定义

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 产品编号 | 字符串 | 6位 | 必填，唯一，默认"P+5位数字"递增，可编辑 | 产品唯一标识 |
| 产品名称 | 字符串 | 100 | 必填 | 产品名称 |
| 价格 | 数字 | 10,2 | 必填，大于0 | 产品单价 |
| 产品分类 | 字符串 | 50 | 可选 | 产品所属分类 |
| 品牌 | 字符串 | 50 | 可选 | 产品品牌 |
| 单位 | 字符串 | 10 | 可选 | 产品计量单位 |
| 启用状态 | 布尔值 | - | 必填，默认启用 | 产品是否启用 |
| 备注 | 文本 | - | 可选 | 产品相关备注信息 |

### 3.3 功能需求

#### 3.3.1 产品列表
- 展示所有产品信息，支持分页和列排序
- 支持按产品编号、名称、分类和状态进行搜索过滤
- 提供新增、编辑、删除和批量删除产品操作按钮

#### 3.3.2 产品创建/编辑
- 使用抽屉式表单进行产品信息录入和编辑
- 表单验证确保必填字段和数据格式正确
- 产品编号默认"P+5位数字"递增，可手动编辑，但需确保唯一性
- 启用状态使用开关组件控制

#### 3.3.3 产品搜索
- 支持按产品编号、名称、分类和状态进行组合搜索
- 实时过滤产品列表

#### 3.3.4 产品删除
- 支持单个产品删除
- 支持批量删除产品
- 删除前弹出确认对话框

### 3.4 操作流程

1. **产品创建流程**：
   - 点击"新增产品"按钮
   - 填写产品信息
   - 提交表单，系统验证数据
   - 验证通过后保存产品信息

2. **产品编辑流程**：
   - 在产品列表中点击"编辑"按钮
   - 修改产品信息
   - 提交表单，系统验证数据
   - 验证通过后更新产品信息

3. **产品删除流程**：
   - 在产品列表中点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除产品信息

4. **批量删除流程**：
   - 在产品列表中选择多个产品
   - 点击"批量删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除所选产品

## 4. 字典管理

### 4.1 功能概述
字典管理功能用于管理系统中使用的各种字典数据，如产品分类、单位、地区等，支持字典类型和字典项的完整CRUD操作。

### 4.2 字段定义

#### 4.2.1 字典类型

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 字典类型编码 | 字符串 | 20 | 必填，唯一 | 字典类型唯一标识 |
| 字典类型名称 | 字符串 | 50 | 必填 | 字典类型名称 |
| 启用状态 | 布尔值 | - | 必填，默认启用 | 字典类型是否启用 |
| 排序 | 数字 | 4 | 必填，默认0 | 字典类型显示顺序 |
| 备注 | 文本 | - | 可选 | 字典类型相关备注信息 |

#### 4.2.2 字典项

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 字典项编码 | 字符串 | 20 | 必填，唯一 | 字典项唯一标识 |
| 字典项名称 | 字符串 | 50 | 必填 | 字典项名称 |
| 字典类型编码 | 字符串 | 20 | 必填 | 所属字典类型 |
| 启用状态 | 布尔值 | - | 必填，默认启用 | 字典项是否启用 |
| 排序 | 数字 | 4 | 必填，默认0 | 字典项显示顺序 |
| 备注 | 文本 | - | 可选 | 字典项相关备注信息 |

### 4.3 功能需求

#### 4.3.1 字典类型管理
- 字典类型列表展示，支持分页和排序
- 支持字典类型的新增、编辑、删除操作
- 支持按字典类型编码和名称搜索
- 支持批量删除字典类型

#### 4.3.2 字典项管理
- 字典项列表展示，按字典类型分组
- 支持字典项的新增、编辑、删除操作
- 支持按字典项编码和名称搜索
- 支持批量删除字典项

#### 4.3.3 字典使用
- 其他模块可通过字典类型编码获取字典项列表
- 支持字典项的级联使用（如地区字典）
- 支持字典项的动态加载

### 4.4 操作流程

1. **字典类型创建流程**：
   - 点击"新增字典类型"按钮
   - 填写字典类型信息
   - 提交表单，系统验证数据
   - 验证通过后保存字典类型

2. **字典项创建流程**：
   - 选择字典类型
   - 点击"新增字典项"按钮
   - 填写字典项信息
   - 提交表单，系统验证数据
   - 验证通过后保存字典项

3. **字典编辑流程**：
   - 在字典列表中点击"编辑"按钮
   - 修改字典信息
   - 提交表单，系统验证数据
   - 验证通过后更新字典信息

4. **字典删除流程**：
   - 在字典列表中点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除字典信息

## 5. 销售管理

### 5.1 功能概述
销售管理功能实现销售订单的完整CRUD操作，包括订单创建、编辑、删除、查询和状态管理，并支持按客户筛选订单。

### 5.2 字段定义

#### 5.2.1 销售订单主信息

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 订单编号 | 字符串 | 7位 | 必填，唯一，默认"S+6位数字"递增，可编辑 | 订单唯一标识 |
| 订单日期 | 日期时间 | - | 必填，默认当天，支持编辑 | 订单创建日期 |
| 客户ID | 字符串 | - | 必填 | 关联客户表的外键 |
| 客户编号 | 字符串 | 4位 | 必填，只读，来自客户表 | 客户唯一标识 |
| 客户名 | 字符串 | 50 | 必填，只读，来自客户表 | 客户姓名或公司简称 |
| 城市 | 字符串 | 50 | 必填，只读，来自客户表 | 客户所在城市 |
| 订单类型 | 字符串 | 20 | 必填 | 门店销售、油管批发、挖机维修 |
| 运费 | 数字 | 10,2 | 必填，默认0 | 订单运费 |
| 物流公司 | 字符串 | 100 | 可选 | 物流公司名称 |
| 物流编号 | 字符串 | 50 | 可选 | 物流跟踪编号 |
| 商品总价 | 数字 | 12,2 | 必填，自动计算 | 所有产品合计金额 |
| 应付金额 | 数字 | 12,2 | 必填，自动计算 | 商品总价+运费 |
| 已收款 | 数字 | 12,2 | 必填，默认0 | 已收到的款项金额 |
| 大写金额 | 字符串 | 100 | 必填，自动计算 | 应付金额的大写形式 |
| 开发票状态 | 字符串 | 20 | 必填 | 未开票、已开票 |
| 付款状态 | 字符串 | 20 | 必填 | 待付款、未结清、已完成、已关闭 |
| 备注 | 文本 | - | 可选 | 订单相关备注信息 |

#### 5.2.2 销售订单产品明细

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 订单ID | 字符串 | - | 必填 | 关联订单表的外键 |
| 产品ID | 字符串 | - | 必填 | 关联产品表的外键 |
| 产品编号 | 字符串 | 6位 | 必填，只读，来自产品表 | 产品唯一标识 |
| 产品名 | 字符串 | 100 | 必填，只读，来自产品表 | 产品名称 |
| 件数 | 数字 | 10,0 | 可选，仅油管批发类型显示 | 产品件数 |
| 数量明细 | 字符串 | 100 | 可选，仅油管批发类型显示 | 数量明细，支持多个数值，用加号或空格分割 |
| 数量 | 数字 | 10,2 | 必填 | 产品数量，数量明细的合计 |
| 单位 | 字符串 | 10 | 必填，只读，来自产品表 | 产品计量单位 |
| 原价 | 数字 | 10,2 | 必填，只读，来自产品表 | 产品原始单价 |
| 优惠 | 数字 | 10,2 | 必填，默认0 | 产品优惠金额 |
| 单价 | 数字 | 10,2 | 必填，可编辑 | 默认等于原价-优惠，修改后自动同步优惠 |
| 合计金额 | 数字 | 12,2 | 必填，自动计算 | 数量*单价 |
| 备注 | 文本 | - | 可选 | 产品相关备注信息 |

### 5.3 功能需求

#### 5.3.1 销售订单列表
- 顶部状态Tabs：全部、待付款、未结清、已完成、已关闭
- 左侧客户列表，按客户编号从小到大排序，支持按客户筛选订单
- 订单列表展示，支持分页和列排序
- 列表字段：创建日期、订单编号、客户名、客户编号、城市、订单类型、产品名、运费、应付金额、已收款、开发票状态、付款状态、备注
- 提供新增、编辑、删除订单操作按钮

#### 5.3.2 销售订单创建/编辑
- 使用右侧抽屉式表单，点击空白区域不关闭，仅通过×或保存/取消按钮关闭
- 订单编号：自动生成"S+6位递增数字"，支持手动编辑，但需确保唯一性
- 订单日期：默认当天，支持编辑
- 客户选择：
  - 弹窗选择客户，支持查询和单选
  - 支持直接新增客户，打开客户新增弹窗
- 订单类型：下拉选择（门店销售、油管批发、挖机维修）
  - 不同订单类型显示不同字段：
    - 仅油管批发类型显示件数、数量明细字段
- 运费信息：
  - 运费默认0，支持编辑
  - 物流公司和物流编号可选填写
- 产品信息管理：
  - 产品列表支持通过弹窗选择产品
  - 支持直接输入产品名查询
  - 支持直接新建产品
  - 支持添加、编辑、删除产品明细
  - 数量支持2位小数
  - 价格显示￥符号和2位小数
- 自动计算：
  - 产品合计金额 = 数量 * 单价
  - 商品总价 = 所有产品合计金额之和
  - 应付金额 = 商品总价 + 运费
  - 大写金额 = 应付金额的大写形式
- 表单验证确保必填字段和数据格式正确

#### 5.3.3 销售订单查询
- 支持按订单编号、客户名、日期范围搜索
- 支持按订单状态筛选
- 支持按客户筛选

#### 5.3.4 销售订单删除
- 支持单个订单删除
- 删除前弹出确认对话框
- 删除后级联删除相关产品明细

### 5.4 操作流程

1. **销售订单创建流程**：
   - 点击"新增订单"按钮
   - 填写订单基本信息（订单日期、客户、订单类型等）
   - 添加产品明细，填写相关信息
   - 确认订单总金额
   - 提交表单，系统验证数据
   - 验证通过后保存订单信息

2. **销售订单编辑流程**：
   - 在订单列表中点击"编辑"按钮
   - 修改订单信息
   - 更新产品明细
   - 确认订单总金额
   - 提交表单，系统验证数据
   - 验证通过后更新订单信息

3. **销售订单删除流程**：
   - 在订单列表中点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除订单信息
   - 同时删除关联的产品明细

4. **按客户筛选订单流程**：
   - 在左侧客户列表中选择客户
   - 右侧订单列表自动筛选该客户的所有订单

## 6. 收款管理

### 6.1 功能概述
收款管理功能实现收款记录的完整CRUD操作，支持批量填写收款信息，并与销售订单关联。

### 6.2 字段定义

| 字段名称 | 数据类型 | 长度 | 约束 | 描述 |
|---------|---------|------|------|------|
| 收款ID | 字符串 | - | 必填，唯一 | 收款记录唯一标识 |
| 收款日期 | 日期 | - | 必填，默认当天，支持编辑 | 收款日期 |
| 客户ID | 字符串 | - | 必填 | 关联客户表的外键 |
| 客户编号 | 字符串 | 4位 | 必填，只读，来自客户表 | 客户唯一标识 |
| 客户名 | 字符串 | 50 | 必填，只读，来自客户表 | 客户姓名或公司简称 |
| 付款金额 | 数字 | 12,2 | 必填，大于0 | 收款金额 |
| 付款方式 | 字符串 | 20 | 必填 | 来自字典管理的付款方式字典 |
| 收款账户 | 字符串 | 50 | 必填 | 来自字典管理的收款账户字典 |
| 付款公司 | 字符串 | 100 | 可选 | 付款公司名称 |
| 备注 | 文本 | - | 可选 | 收款相关备注信息 |

### 6.3 功能需求

#### 6.3.1 收款记录列表
- 展示所有收款记录，支持分页和列排序
- 列表字段：收款日期、客户编号、客户名、付款金额、付款方式、收款账户、付款公司
- 提供新增、编辑、删除收款记录操作按钮
- 支持批量填写收款记录

#### 6.3.2 收款记录创建/编辑
- 使用表单进行收款信息录入和编辑
- 收款日期：默认当天，支持编辑
- 客户选择：弹窗选择客户，支持查询和单选
- 付款方式：下拉选择，数据来源字典管理
- 收款账户：下拉选择，数据来源字典管理
- 付款金额：必填，大于0，支持2位小数
- 表单验证确保必填字段和数据格式正确

#### 6.3.3 批量填写收款记录
- 支持通过弹窗批量录入多条收款记录
- 弹窗中以列表形式展示，支持添加、删除行
- 每条记录包含完整的收款信息字段
- 支持批量保存所有收款记录

#### 6.3.4 收款记录查询
- 支持按收款日期、客户名、付款方式、收款账户搜索
- 支持按日期范围筛选

#### 6.3.5 收款记录删除
- 支持单个收款记录删除
- 删除前弹出确认对话框

### 6.4 操作流程

1. **收款记录创建流程**：
   - 点击"新增收款"按钮
   - 填写收款信息
   - 提交表单，系统验证数据
   - 验证通过后保存收款记录

2. **收款记录编辑流程**：
   - 在收款列表中点击"编辑"按钮
   - 修改收款信息
   - 提交表单，系统验证数据
   - 验证通过后更新收款记录

3. **批量填写收款记录流程**：
   - 点击"批量填写"按钮
   - 在弹窗中添加多条收款记录
   - 填写每条记录的收款信息
   - 点击"保存"按钮，系统验证所有数据
   - 验证通过后批量保存所有收款记录

4. **收款记录删除流程**：
   - 在收款列表中点击"删除"按钮
   - 系统弹出确认对话框
   - 用户确认后删除收款记录

## 7. 技术实现要求

### 7.1 前端技术栈
- 框架：Next.js 13+ (App Router)
- 语言：TypeScript
- UI组件库：Ant Design
- HTTP客户端：Fetch API

### 7.2 后端技术栈
- 语言：Go
- Web框架：Gin
- 数据库：MySQL
- ORM：原生SQL查询

### 7.3 数据交互
- 前后端通过RESTful API进行数据交互
- 数据格式：JSON
- 状态码：HTTP标准状态码

### 7.4 安全性要求
- 所有API请求需进行身份验证
- 输入数据需进行严格验证，防止SQL注入和XSS攻击
- 敏感数据需进行加密存储

## 8. 性能要求

- 列表页面加载时间不超过2秒
- 表单提交响应时间不超过1秒
- 支持至少1000条数据的流畅展示和操作

## 9. 兼容性要求

- 支持Chrome、Firefox、Safari、Edge等主流浏览器
- 支持响应式设计，适配不同屏幕尺寸

## 10. 测试要求

- 功能测试：确保所有功能正常工作
- 性能测试：确保系统在高负载下仍能正常运行
- 兼容性测试：确保在不同浏览器和设备上正常显示
- 安全测试：确保系统安全可靠，防止常见攻击

## 11. 交付物

- 前端代码
- 后端代码
- 数据库脚本
- 接口文档
- 测试报告

## 12. 验收标准

- 所有功能按需求文档实现
- 系统运行稳定，无明显性能问题
- 代码结构清晰，易于维护
- 符合安全性和兼容性要求

## 13. 后续扩展建议

- 实现客户等级管理
- 添加产品图片上传功能
- 实现产品库存预警
- 添加字典数据导入导出功能
- 实现数据统计和报表功能
